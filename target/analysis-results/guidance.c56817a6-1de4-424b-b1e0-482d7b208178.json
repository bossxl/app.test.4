{
  "id": "c56817a6-1de4-424b-b1e0-482d7b208178",
  "trigger": "9d8a3436-3947-4e41-839b-5b197ab16e31",
  "category": "ROUTE",
  "event": {
    "boundParams": [
      "date",
      "ttb",
      "wtb",
      "primitive",
      "masked",
      "values",
      "defaultCenturyStart",
      "list",
      "nested",
      "serialVersionUID",
      "cdate",
      "fastTime",
      "jcal",
      "gcal",
      "formattedList",
      "value",
      "map"
    ],
    "allowedParams": [],
    "disallowedParams": [],
    "missingParams": [],
    "initBinder": false,
    "controllerclass": "ConvertController",
    "requestHandlerSignatures": [
      "collection(@RequestParam()Collection\u003cInteger\u003e values)",
      "valueObject(@RequestParam()SocialSecurityNumber value)",
      "bean(JavaBean bean)",
      "primitive(@RequestParam()Integer value)",
      "formattedCollection(@RequestParam()@DateTimeFormat(iso \u003d ISO.DATE)Collection\u003cDate\u003e values)",
      "customConverter(@RequestParam()@MaskFormat(value \u003d \"###-##-####\")String value)",
      "date(@PathVariable()@DateTimeFormat(iso \u003d ISO.DATE)Date value)"
    ],
    "category": "ROUTE",
    "id": "9d8a3436-3947-4e41-839b-5b197ab16e31"
  },
  "evidence": "# Create a Spring @InitBinder Method\n\nOur analysis determined that the `@InitBinder` method for `ConvertController` was not present, resulting in the ability for\nparameters passed on the Request to the `@RequestHandler` to override parameters that may not otherwise be exposed. We\nhave analyzed the the code and found the following parameters to be exposed to the request currently through Spring\u0027s\nauto-binding:\n\n    * date\n    * ttb\n    * wtb\n    * primitive\n    * masked\n    * values\n    * defaultCenturyStart\n    * list\n    * nested\n    * serialVersionUID\n    * cdate\n    * fastTime\n    * jcal\n    * gcal\n    * formattedList\n    * value\n    * map\n\nFor additional context, we discovered the following `@RequestHandler` methods in this controller that accept parameters\nfrom the request.\n\n    * `collection(@RequestParam()Collection\u0026lt;Integer\u0026gt; values)`\n    * `valueObject(@RequestParam()SocialSecurityNumber value)`\n    * `bean(JavaBean bean)`\n    * `primitive(@RequestParam()Integer value)`\n    * `formattedCollection(@RequestParam()@DateTimeFormat(iso \u003d ISO.DATE)Collection\u0026lt;Date\u0026gt; values)`\n    * `customConverter(@RequestParam()@MaskFormat(value \u003d \u0026quot;###-##-####\u0026quot;)String value)`\n    * `date(@PathVariable()@DateTimeFormat(iso \u003d ISO.DATE)Date value)`\n\nUse our sandbox below to fine-tune which parameters you would like to explicitly allow to be set. Anything explicitly\npassed to the `setAllowedFields` method will be _whitelisted_ for inclusion while any parameter that is excluded will\nbe considered a read-only attribute and the value will not be set when Spring performs auto-binding.\n",
  "advice": [
    {
      "sandboxModel": {
        "boundParams": [
          "date",
          "ttb",
          "wtb",
          "primitive",
          "masked",
          "values",
          "defaultCenturyStart",
          "list",
          "nested",
          "serialVersionUID",
          "cdate",
          "fastTime",
          "jcal",
          "gcal",
          "formattedList",
          "value",
          "map"
        ]
      },
      "file": "/Users/cschmidt/IdeaProjects/lofting.poc.java.analyzer/test/app.test.4/src/main/java/org/springframework/samples/mvc/convert/ConvertController.java",
      "content": "\n\r    /**\n\r     * Added by Codiscope {{product}} on {{date}}\n\r     *\n\r     * @GuidanceID({{guidance.id}})\n\r     *\n\r     * Whitelist the properties that can be auto-bound to parameters and fields\n\r     **************************************************************************/\n\r    @InitBinder\n\r    public void initBinder(org.springframework.validation.DataBinder dataBinder) {\n\r        dataBinder.setAllowedFields({{#allowedFields}}\"{{field}}\"{{^last}},{{/last}}{{/allowedFields}});\n\r    }\n\r",
      "type": "SandboxAdvice"
    }
  ]
}